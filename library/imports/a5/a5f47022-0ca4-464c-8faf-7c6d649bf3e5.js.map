{"version":3,"sources":["../../../../../../assets/JJGame/Script/game/assets/JJGame/Script/game/topBarDelegate.js"],"names":["cc","Class","extends","Component","properties","onLoad","score","_label","node","getChildByName","score_label","getComponent","Label","_bar","energt_bar","ProgressBar","Atom","gameDataMgr","setData","getData","energyDeplete","gameConfMgr","getInfo","energyFull","mEnergy","start","eventMgr","listen","obj","data","onAddScore","onBuffEnergy","onDestroy","unListenByObj","console","log","Math","ceil","string","energy","min","mUpdate","dt","deplete","notify","_type","progress","onPause","onMusic","isMusicOn","isEffectOn"],"mappings":"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","file":"topBarDelegate.js","sourceRoot":"../../../../../../assets/JJGame/Script/game","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n       // score_label:{\n       //      default:null,\n       //      type:cc.Node,\n       //  },\n    },\n\n    onLoad () {\n        this.score = 0;\n        this._label = this.node.getChildByName(\"textScore\");\n        this.score_label = this._label.getComponent(cc.Label);\n\n        this._bar = this.node.getChildByName(\"energt_bar\");\n        this.energt_bar = this._bar.getComponent(cc.ProgressBar)\n\n        cc.Atom.gameDataMgr.setData(\"mEnergy\" , 100)\n        cc.Atom.gameDataMgr.getData(\"mEnergy\")\n\n        this.energyDeplete = cc.Atom.gameConfMgr.getInfo(\"energyDeplete\")\n        this.energyFull    = cc.Atom.gameConfMgr.getInfo(\"energyFull\")\n        this.mEnergy       = this.energyFull\n    },\n\n    start () {\n        cc.Atom.eventMgr.listen(\"onAddScore\"   , (obj,data)=>{ this.onAddScore(data)     }, this) \n        cc.Atom.eventMgr.listen(\"onBuffEnergy\" , (obj,data)=>{ this.onBuffEnergy()       }, this)\n    },\n\n    onDestroy(){\n        cc.Atom.eventMgr.unListenByObj(this)\n    },\n\n    onAddScore(data){\n        console.log(\">>>>>>>> onAddScore\" + data)\n        this.score += Math.ceil(data);\n        this.score_label.string = \"SCORE : \" + this.score;\n    },\n\n    onBuffEnergy(){\n        console.log(\">>>>>>> onBuffEnergy\")\n        var energy = this.mEnergy + cc.Atom.gameConfMgr.getInfo(\"buffEnergy\")\n        this.mEnergy = Math.min(energy , this.energyFull)\n    },\n    \n    mUpdate (dt) {\n        var deplete = this.energyDeplete * dt\n        this.mEnergy -= deplete;\n        if(this.mEnergy <=0 ){\n            cc.Atom.eventMgr.notify(\"onGameOver\",{ _type: \"noEnergy\"})\n            return;\n        }\n        console.log(\">>>> mEnergy %d\" , this.mEnergy/this.energyFull)\n        this.energt_bar.progress = this.mEnergy/this.energyFull\n    },\n\n    onPause(){\n        cc.Atom.eventMgr.notify(\"onPause\",true)\n    },\n\n    onMusic(){\n        var isMusicOn = cc.Atom.gameDataMgr.getData(\"isMusicOn\")\n        var isEffectOn = cc.Atom.gameDataMgr.getData(\"isEffectOn\")\n\n        cc.Atom.gameDataMgr.getData(\"isMusicOn\",  !(isMusicOn || isEffectOn))\n        cc.Atom.gameDataMgr.getData(\"isEffectOn\", !(isMusicOn || isEffectOn))\n    }\n\n\n});\n"]}