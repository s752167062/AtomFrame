{"version":3,"sources":["../../../../../../assets/JJGame/Script/common/assets/JJGame/Script/common/uiLoader.js"],"names":["cc","Class","extends","Component","properties","onLoad","logo_bg","node","getChildByName","game_bg","press_bar","Atom","console","log","atom","require","createAtom","gameState","setGameInLogo","getComponent","ProgressBar","self","active","isGameInLogo","isGameInRoom","timerMgr","registerTask","TASK_TYPE_ONE","desc","setGameInHall","director","loadScene","isGameInHall","resMgr","loadResByKey","index","total","err","progress","removeFromParent","eventMgr","notify","start","update","dt"],"mappings":";;;;;;AAAA;AACA;;;;AAIAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AAPQ,KAHP;;AAcL;AACAC,UAfK,oBAeK;AAAA;;AACN,YAAIC,UAAU,KAAKC,IAAL,CAAUC,cAAV,CAAyB,SAAzB,CAAd;AACA,YAAIC,UAAU,KAAKF,IAAL,CAAUC,cAAV,CAAyB,SAAzB,CAAd;AACA,YAAIE,YAAW,KAAKH,IAAL,CAAUC,cAAV,CAAyB,aAAzB,CAAf;;AAEA,YAAGR,GAAGW,IAAH,IAAW,IAAd,EAAmB;AACf;AACAC,oBAAQC,GAAR,CAAY,eAAZ;AACA,gBAAMC,OAAOC,QAAQ,MAAR,CAAb;AACAD,iBAAKE,UAAL;;AAEA;AACAhB,eAAGW,IAAH,CAAQM,SAAR,CAAkBC,aAAlB;AACH;;AAED,aAAKR,SAAL,GAAiBA,UAAUS,YAAV,CAAuBnB,GAAGoB,WAA1B,CAAjB,CAfM,CAekD;AACxD,YAAMC,OAAO,IAAb;AACAf,gBAAQgB,MAAR,GAAiBtB,GAAGW,IAAH,CAAQM,SAAR,CAAkBM,YAAlB,EAAjB,CAjBM,CAiB4C;AAClDd,gBAAQa,MAAR,GAAiBtB,GAAGW,IAAH,CAAQM,SAAR,CAAkBO,YAAlB,EAAjB,CAlBM,CAkB4C;;AAElD;AACA,YAAGxB,GAAGW,IAAH,CAAQM,SAAR,CAAkBM,YAAlB,EAAH,EAAqC;AACjCvB,eAAGW,IAAH,CAAQc,QAAR,CAAiBC,YAAjB,CAA8B,WAA9B,EAA2C1B,GAAGW,IAAH,CAAQc,QAAR,CAAiBE,aAA5D,EAA2E,YAAM;AAC7Ef,wBAAQC,GAAR,CAAY,MAAKe,IAAjB,EAAuB,iBAAvB;AACA5B,mBAAGW,IAAH,CAAQM,SAAR,CAAkBY,aAAlB;AACA7B,mBAAG8B,QAAH,CAAYC,SAAZ,CAAsB,yBAAtB;AACH,aAJD,EAIG,CAJH;AAKA;AACH;;AAED;AACA,YAAG/B,GAAGW,IAAH,CAAQM,SAAR,CAAkBe,YAAlB,EAAH,EAAoC;AAChC;AACA;AACH;;AAED;AACA,YAAGhC,GAAGW,IAAH,CAAQM,SAAR,CAAkBO,YAAlB,EAAH,EAAoC;AAChCZ,oBAAQC,GAAR,CAAY,6BAAZ;AACAb,eAAGW,IAAH,CAAQsB,MAAR,CAAeC,YAAf,CAA4B,WAA5B,EAA0C,UAACC,KAAD,EAASC,KAAT,EAAiBC,GAAjB,EAAuB;AAC7D,oBAAGA,OAAO,IAAP,IAAeF,SAAS,CAAC,CAA5B,EAA8B;AAC1BvB,4BAAQC,GAAR,CAAY,gBAAZ,EAA6BwB,GAA7B;AACA;AACA;AACH;AACDzB,wBAAQC,GAAR,CAAY,YAAZ,EAA0BsB,KAA1B,EAAkCC,KAAlC;AACA,sBAAK1B,SAAL,CAAe4B,QAAf,GAA0BH,QAAMC,KAAhC;AACA,oBAAGD,SAASC,KAAZ,EAAkB;AACdxB,4BAAQC,GAAR,CAAY,UAAZ;AACA,0BAAKN,IAAL,CAAUgC,gBAAV;AACAvC,uBAAGW,IAAH,CAAQ6B,QAAR,CAAiBC,MAAjB,CAAwB,aAAxB,EAAsC,IAAtC;AACH;AACJ,aAbD;AAcA;AACH;AAEJ,KAvEI;AAyELC,SAzEK,mBAyEI,CAER,CA3EI;AA6ELC,UA7EK,kBA6EGC,EA7EH,EA6EO,CAEX;AA/EI,CAAT","file":"uiLoader.js","sourceRoot":"../../../../../../assets/JJGame/Script/common","sourcesContent":["//加载页面\n/*\n    关于require 的相关说明参考    http://docs.cocos.com/creator/manual/zh/scripting/modular-script.html\n                                https://github.com/czlbaiyi/zergnest_client_creator\n*/\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // logo_bg: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n    },\n\n\n    // LIFE-CYCLE CALLBACKS:\n    onLoad () {\n        var logo_bg = this.node.getChildByName(\"logo_bg\");\n        var game_bg = this.node.getChildByName(\"game_bg\");\n        var press_bar= this.node.getChildByName(\"progressBar\");\n\n        if(cc.Atom == null){\n            //创建 Atom引擎\n            console.log(\">>> 创建 Atom引擎\")\n            const atom = require(\"Atom\");\n            atom.createAtom();\n\n            //初始logo状态\n            cc.Atom.gameState.setGameInLogo()\n        }\n\n        this.press_bar = press_bar.getComponent(cc.ProgressBar);// creator prefab 创建的对象无法直接像绑定脚本那样操作非node内容，需要而外getComponent来获取组件操作\n        const self = this;\n        logo_bg.active = cc.Atom.gameState.isGameInLogo() //\n        game_bg.active = cc.Atom.gameState.isGameInRoom() //\n\n        //加载\n        if(cc.Atom.gameState.isGameInLogo()) {\n            cc.Atom.timerMgr.registerTask(\"logo2hall\", cc.Atom.timerMgr.TASK_TYPE_ONE, () => { \n                console.log(this.desc, \" ---- logo2Game\") \n                cc.Atom.gameState.setGameInHall()\n                cc.director.loadScene(\"JJGame/Scene/JJHallMain\");\n            }, 2)\n            return \n        }\n\n        //大厅界面\n        if(cc.Atom.gameState.isGameInHall()){\n            //正常这里要加载大厅相关的资源\n            return\n        }\n\n        //游戏场景\n        if(cc.Atom.gameState.isGameInRoom()){\n            console.log(\">>> uiloader load JJGameRes\");\n            cc.Atom.resMgr.loadResByKey(\"JJGameRes\" , (index , total , err)=>{\n                if(err != null || index == -1){\n                    console.log(\"=== 加载资源出现异常： \",err);\n                    //need to fix ,do someting !\n                    return\n                }\n                console.log(\" 资源加载进度 ： \" ,index , total);\n                this.press_bar.progress = index/total;\n                if(index == total){\n                    console.log(\"=== 加载完成\")\n                    this.node.removeFromParent();\n                    cc.Atom.eventMgr.notify(\"onStartGame\",null)\n                }\n            }) \n            return\n        }\n\n    },\n\n    start () {\n\n    },\n\n    update (dt) {\n\n    },\n});\n"]}